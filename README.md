# API для cоциальной сети YaTube

## Возможности

#### Работа с постами

 - Получение постов с использованием пагинации (необходимо передать параметры limit и offset)
 - Добавление постоа авторизованным пользователем
 - Получение конкретного поста по id
 - Частичное или полное обновление, удаление поста автором

#### Работа с комментариями

 - Получение комментариев к посту (без использования пагинации)
 - Добавление комментария авторизованным пользователем
 - Получение конкретного комментария по id
 - Частичное или полное обновление, удаление комментария автором

#### Работа с сообществами

 - Получение списка сообществ или конкретного сообщества по id

#### Работа с подписками

 - Получение всех подписок авторизованного пользователя
 - Подписка авторизованного пользователя на другого пользователя, переданного в теле запроса

#### Авторизованная работа

 - Получение JWT-токена
 - Обновление JWT-токена

## Установка

*Для работы с проектом в системе должен быть установлен Python версии 3.7*

### Клонировать репозиторий и перейти в него в командной строке:

```
git clone https://github.com/eduvxn/api_final_yatube.git
```

```
cd api_final_yatube

```

### Cоздать и активировать виртуальное окружение:

```
python3 -m venv env
```
#### команда для Linux
```
source venv/bin/activate
```
#### команда для windows
```
source venv/Scripts/activate
```
```
python3 -m pip install --upgrade pip
```

### Установить зависимости из файла requirements.txt:

```
pip install -r requirements.txt
```

### Выполнить миграции:

```
python3 manage.py migrate
```

### Запуск

```
python3 manage.py runserver
```

## Использование

После запуска сервера вам будет доступна [документация](http://localhost:8000/redoc/)

### Примеры работы с API для пользователей
Для неавторизованных пользователей работа с API доступна в режиме чтения.
```bash
GET api/v1/posts/ - получение списка всех постов
При указании параметров limit и offset выдача работает с пагинацией
GET api/v1/posts/{id}/ - получение поста по id

GET api/v1/groups/ - получение списка всех сообществ
GET api/v1/groups/{id}/ - получение информации о сообществе по id

GET api/v1/{post_id}/comments/ - получение всех комментариев к посту
GET api/v1/{post_id}/comments/{id}/ - Получение комментария к посту по id
```
### Примеры работы с API для авторизованных пользователей
Создание поста:
```bash
POST /api/v1/posts/
```
в body
{
"text": "string",
"image": "string",
"group": 0
}

Обновление поста:
```bash
PUT /api/v1/posts/{id}/
```
в body
{
"text": "string",
"image": "string",
"group": 0
}

Частичное обновление поста:
```bash
PATCH /api/v1/posts/{id}/
```
в body
{
"text": "string",
"image": "string",
"group": 0
}

Удаление поста:
```bash
DEL /api/v1/posts/{id}/
```
Получение доступа к эндпоинту /api/v1/follow/
(отвечает за функционал подписок) возможно только для авторизованных пользователей.
```bash
GET /api/v1/follow/ - подписка пользователя, от имени которого сделан запрос
на пользователя переданного в теле запроса.
```

### Добавить сообщество возможно через админ панель Django:
```bash
admin/ - после авторизации переходим в раздел Groups, где можем создать сообщество
```
Доступ авторизованным пользователем доступен по JWT-токену (Joser),
для его получения необходимо выполнить POST запрос к эндпоинту:
```bash
POST /api/v1/jwt/create/
```
Передав в body (для Postman) данные пользователя:
```bash
{
"username": "string",
"password": "string"
}
```
Полученный токен добавляем в headers (для Postman), после чего будет доступен полный функционал API:
```bash
Authorization: Bearer {your_token}
```
Обновить JWT-токен:
```bash
POST /api/v1/jwt/refresh/ - обновление JWT-токена
```
Проверить JWT-токен:
```bash
POST /api/v1/jwt/verify/ - проверка JWT-токена
```


## Технологии
* [Python](https://www.python.org/)
* [Django](https://www.djangoproject.com/)
* [Django REST framework](https://www.django-rest-framework.org/)
* [DRF Simple JWT](https://django-rest-framework-simplejwt.readthedocs.io/en/latest/)
